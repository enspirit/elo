CASE WHEN lower(tstzrange(LEAST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 12:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 11:00:00', TIMESTAMP '2024-01-01 14:00:00'))), GREATEST(upper(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 12:00:00')), upper(tstzrange(TIMESTAMP '2024-01-01 11:00:00', TIMESTAMP '2024-01-01 14:00:00'))))) = TIMESTAMP '2024-01-01 10:00:00' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN upper(tstzrange(LEAST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 12:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 11:00:00', TIMESTAMP '2024-01-01 14:00:00'))), GREATEST(upper(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 12:00:00')), upper(tstzrange(TIMESTAMP '2024-01-01 11:00:00', TIMESTAMP '2024-01-01 14:00:00'))))) = TIMESTAMP '2024-01-01 14:00:00' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN lower(tstzrange(LEAST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))), GREATEST(upper(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), upper(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))))) = TIMESTAMP '2024-01-01 10:00:00' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN upper(tstzrange(LEAST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))), GREATEST(upper(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), upper(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))))) = TIMESTAMP '2024-01-01 15:00:00' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN lower((CASE WHEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00') && tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00') THEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00') * tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00') ELSE tstzrange(GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00'))), GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00'))), '[]') END)) = TIMESTAMP '2024-01-01 12:00:00' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN upper((CASE WHEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00') && tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00') THEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00') * tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00') ELSE tstzrange(GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00'))), GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 14:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 12:00:00', TIMESTAMP '2024-01-01 16:00:00'))), '[]') END)) = TIMESTAMP '2024-01-01 14:00:00' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN lower((CASE WHEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00') && tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00') THEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00') * tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00') ELSE tstzrange(GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))), GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))), '[]') END)) = upper((CASE WHEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00') && tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00') THEN tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00') * tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00') ELSE tstzrange(GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))), GREATEST(lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 11:00:00')), lower(tstzrange(TIMESTAMP '2024-01-01 14:00:00', TIMESTAMP '2024-01-01 15:00:00'))), '[]') END)) THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN (upper(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 12:00:00')) - lower(tstzrange(TIMESTAMP '2024-01-01 10:00:00', TIMESTAMP '2024-01-01 12:00:00'))) = INTERVAL 'PT2H' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
CASE WHEN (upper(tstzrange(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-02 00:00:00')) - lower(tstzrange(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-02 00:00:00'))) = INTERVAL 'P1D' THEN TRUE ELSE (SELECT pg_terminate_backend(pg_backend_pid())) END
